<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://sitodo-example.herokuapp.com/bootcamp/day-1/qa-automation/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Deployment Automation - Sitodo</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Deployment Automation";
        var mkdocs_page_input_path = "bootcamp\\day-1\\qa-automation.md";
        var mkdocs_page_url = "/bootcamp/day-1/qa-automation/";
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Sitodo
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../..">Course Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Day One</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../init-spring/">Initialise Project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hello-tdd/">Hello, TDD</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Deployment Automation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#setting-up-github-actions">Setting Up GitHub Actions</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basic-list/">Create a Basic Todo List</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../end-day-1/">Recap</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Day Two</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../day-2/test-automation/">Test Automation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../day-2/update-data-model/">One of Many Lists</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Sitodo</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Day One &raquo;</li>
      <li>Deployment Automation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="quality-assurance-automation">Quality Assurance &amp; Automation</h1>
<p>In order to make the production code can be built and deployed on Heroku,
we have to follow the rules dictated by the service provider (i.e. Heroku).</p>
<p>Create a new file called <code>Procfile</code> in the root project directory.
It defines one or more processes that can run on Heroku's environment.
For our purpose today, you only need to define a single process called <code>web</code> that runs the application.
The content can be seen in the following snippet:</p>
<pre><code class="language-procfile">web: java -Dserver.port=$PORT $JAVA_OPTS -jar target/*.jar
</code></pre>
<p>You also need to create a new file named <code>system.properties</code> in the root project directory.
It will be used to bind a specific version of Java to the deployment environment.
The content can be seen in the following snippet:</p>
<pre><code class="language-properties">java.runtime.version=17
</code></pre>
<p>Add new files into local Git history and push the commit to GitHub:</p>
<pre><code class="language-shell">git add Procfile system.properties
git commit
git push origin main
</code></pre>
<h2 id="setting-up-github-actions">Setting Up GitHub Actions</h2>
<p>Create a new file with name <code>dpl.yml</code> in <code>.github/workflows</code> folder in your root project directory.
This file is used to execute <em>deployment</em> by <em>runner</em> from GitHub Actions.
The content of the <code>dpl.yml</code> is as follows:</p>
<pre><code class="language-yml">---
name: Deploy

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-22.04
    env:
      HEROKU_API_KEY: ${{ secrets.HEROKU_API_KEY }}
      HEROKU_APP_NAME: ${{ secrets.HEROKU_APP_NAME }}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: &quot;2.7&quot;
      - name: Install dpl
        run: gem install dpl
      - name: Deploy to Heroku
        run: dpl --provider=heroku --app=$HEROKU_APP_NAME --api-key=$HEROKU_API_KEY
      - uses: chrnorm/deployment-action@releases/v1
        name: Create GitHub deployment
        with:
          initial_status: success
          token: ${{ github.token }}
          target_url: https://${{ secrets.HEROKU_APP_NAME }}.herokuapp.com
          environment: production
</code></pre>
<p>After you perform all the procedures above, your new Spring Boot application is ready to deploy in Heroku.
If you open the GitHub Actions tab in your repository, it seems that a <em>workflow</em> is already running,
but the status is failed because there is an error that says there are some parameters in <em>deployment</em> job that were not found.
This thing happened because you have not configured the parameters needed by the <em>workflow</em>.
Now, you will configure those parameters:</p>
<ol>
<li>Create a Heroku account if you have not done so.
   You can create a Heroku account on its login page on <a href="https://id.heroku.com/login">this link</a>.
   Once you have logged in to the dashboard page, create a Heroku app and take note of the name.</li>
<li>Copy API Key from your account. API Key can be found in <code>Account Settings -&gt; API Key</code>. Keep your API Key and the information about your Heroku application in a text file with given format:
   <code>HEROKU_API_KEY: &lt;YOUR_API_KEY_VALUE&gt;
   HEROKU_APP_NAME: &lt;YOUR_HEROKU_APPLICATION_NAME&gt;</code></li>
<li>Open your GitHub repository configuration and open the Secrets section for GitHub Actions (<code>Settings -&gt; Secrets -&gt; Actions</code>).</li>
<li>Add a new <code>repository secret</code> variable to do the <em>deployment</em>. Key-Value pair from the variable that youâ€™ll make can be obtained from the information that you noted in the previous text file. Example can be seen below:
   <code>(NAME)HEROKU_APP_NAME
   (VALUE)MY-APPLICATION</code></li>
<li>Keep the notes above somewhere outside the repository. <strong>Do not commit your note file into Git, since it contains your Heroku key!</strong></li>
<li>Open GitHub Actions and re-run the failed <em>workflow</em>.</li>
</ol>
<p>After you re-run <em>workflow</em> and <em>deployment</em> status become success (can be seen from the green checklist symbol on your repository),
you can access the application in <code>https://&lt;heroku-application-name&gt;.herokuapp.com</code>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../hello-tdd/" class="btn btn-neutral float-left" title="Hello, TDD"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../basic-list/" class="btn btn-neutral float-right" title="Create a Basic Todo List">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../hello-tdd/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../basic-list/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
